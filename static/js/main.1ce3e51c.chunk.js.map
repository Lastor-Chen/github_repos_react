{"version":3,"sources":["apis/githubAPI.ts","components/UserCard.tsx","apis/dayjs.ts","components/RepoCard.tsx","components/Spinner.tsx","components/Repos.tsx","views/Home.tsx","App.tsx","index.tsx"],"names":["apiHelper","axios","create","baseURL","USER","githubAPI","pageLimit","getRepos","page","get","getUser","UserCard","state","user","avatar_url","name","accountName","fetchUser","a","data","setState","login","props","onFetchedUser","public_repos","Swal","fire","this","className","src","alt","title","Component","dayjs","extend","relativeTime","RepoCard","ISOString","fromNow","repo","homepage","href","description","html_url","ifHomepage","data-color","language","updated_at","ifDescription","Spinner","role","Repos","repos","isLoading","observe","obRef","React","createRef","fetchRepos","map","id","newRepos","concat","loadMoreRepos","entries","isIntersecting","windowHeight","window","innerHeight","obPosition","current","offsetTop","isOverWindow","totalPage","disconnect","IntersectionObserver","length","ifSpinner","ref","Home","bgImg","bgPath","process","updateTotalPage","reposSize","Math","ceil","handleScroll","innerWidth","scrollTop","scrollY","toFixed","style","backgroundPositionY","opacity","addEventListener","backgroundImage","App","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.1ce3e51c.chunk.js","sourcesContent":["import axios from 'axios'\r\n\r\nconst apiHelper = axios.create({\r\n  baseURL: 'https://api.github.com'\r\n})\r\n\r\nconst USER = 'lastor-chen'  // github username\r\nconst LIMIT = 7             // page limit\r\nconst SORT_BY = 'pushed'\r\n\r\nconst githubAPI = {\r\n  pageLimit: LIMIT,\r\n  getRepos(page: number) {\r\n    return apiHelper.get(`/users/${USER}/repos?sort=${SORT_BY}&page=${page}&per_page=${LIMIT}`)\r\n  },\r\n  getUser() {\r\n    return apiHelper.get(`https://api.github.com/users/${USER}`)\r\n  }\r\n}\r\n\r\nexport default githubAPI","import { Component } from 'react'\r\n\r\nimport Swal from 'sweetalert2'\r\n\r\nimport './UserCard.css'\r\nimport githubAPI from '../apis/githubAPI'\r\n\r\ninterface Props {\r\n  onFetchedUser: (repos: number) => void\r\n}\r\n\r\nclass UserCard extends Component<Props> {\r\n  state = {\r\n    user: {\r\n      avatar_url: 'https://via.placeholder.com/253?text=No+Image',  // default img\r\n      name: '',\r\n      accountName: ''\r\n    }\r\n  }\r\n\r\n  fetchUser = async () => {\r\n    try {\r\n      const { data } = await githubAPI.getUser()\r\n      this.setState({\r\n        user: {\r\n          avatar_url: data.avatar_url as string,\r\n          name: data.name as string,\r\n          accountName: data.login as string,\r\n        }\r\n      })\r\n\r\n      this.props.onFetchedUser(data.public_repos)\r\n    } catch (err) {\r\n      Swal.fire('503', '無法取得 User，請稍後再試', 'error')\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.fetchUser()\r\n  }\r\n\r\n  render() {\r\n    const user = this.state.user\r\n\r\n    return (\r\n      <div className=\"card avatar-card-rwd\">\r\n        <img\r\n          src={user.avatar_url}\r\n          alt=\"user_avatar\"\r\n          title={user.accountName}\r\n          className=\"card-img-top\"\r\n        />\r\n        <div className=\"card-body\">\r\n          <h5>{user.name}</h5>\r\n          <p className=\"mb-0\">{user.accountName}</p>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default UserCard\r\n","import dayjs from 'dayjs'\r\nimport relativeTime from 'dayjs/plugin/relativeTime'\r\n\r\ndayjs.extend(relativeTime)\r\n\r\nexport default dayjs","import { Component } from 'react'\r\nimport dayjs from '../apis/dayjs'\r\nimport { Repo } from './Repos'\r\nimport './RepoCard.css'\r\n\r\nexport interface RepoCardProps {\r\n  repo: Repo\r\n}\r\n\r\nclass RepoCard extends Component<RepoCardProps> {\r\n  fromNow(ISOString: string) {\r\n    return dayjs(ISOString).fromNow()\r\n  }\r\n\r\n  ifHomepage(repo: Repo) {\r\n    if (!repo.homepage) return null\r\n\r\n    return (\r\n      <div className=\"ms-3\">\r\n        <a href={repo.homepage}>\r\n          <span className=\"badge bg-info\">demo</span>\r\n        </a>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  ifDescription(repo: Repo) {\r\n    if (repo.description) {\r\n      return <p className=\"card-text\">{repo.description}</p>\r\n    } else {\r\n      return <p className=\"card-text text-muted\">No description...</p>\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const repo = this.props.repo\r\n\r\n    return (\r\n      <div className=\"card mb-3\">\r\n        <div className=\"card-body\">\r\n          <div className=\"card-title d-flex mb-0\">\r\n            <a href={repo.html_url} className=\"text-decoration-none\">\r\n              <h5 className=\"mb-0 fw-bold\">{repo.name}</h5>\r\n            </a>\r\n            {this.ifHomepage(repo)}\r\n          </div>\r\n          <div className=\"repo-info my-3\">\r\n            <span className=\"lang-dot me-3\" data-color={repo.language}>\r\n              {repo.language}\r\n            </span>\r\n            <span>Updated {this.fromNow(repo.updated_at)}</span>\r\n          </div >\r\n          <hr />\r\n          {this.ifDescription(repo) }\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default RepoCard","function Spinner() {\r\n  return (\r\n    <div className=\"text-center\">\r\n      <div className=\"spinner-border\" role=\"status\">\r\n        <span className=\"sr-only\"></span>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Spinner","import React, { Component } from 'react'\r\nimport Swal from 'sweetalert2'\r\n\r\nimport RepoCard from './RepoCard'\r\nimport Spinner from './Spinner'\r\nimport githubAPI from '../apis/githubAPI'\r\n\r\nexport interface Repo {\r\n  id: number,\r\n  name: string,\r\n  description: string,\r\n  html_url: string,\r\n  language: string,\r\n  homepage: string,\r\n  updated_at: string,\r\n}\r\n\r\nexport interface ReposProps {\r\n  totalPage: number\r\n}\r\n\r\nclass Repos extends Component<ReposProps> {\r\n  state = {\r\n    repos: [] as Repo[],\r\n    isLoading: false,\r\n    page: 1,\r\n  }\r\n\r\n  observe: IntersectionObserver = null as any // 監看滾動分頁\r\n  obRef = React.createRef() as React.RefObject<HTMLDivElement>\r\n\r\n  fetchRepos = async (page: number) => {\r\n    try {\r\n      this.setState({ isLoading: true })\r\n      const { data } = await githubAPI.getRepos(page)\r\n\r\n      const repos = data.map((repo: Repo) => ({\r\n        id: repo.id,\r\n        name: repo.name,\r\n        description: repo.description,\r\n        html_url: repo.html_url,\r\n        language: repo.language,\r\n        homepage: repo.homepage,\r\n        updated_at: repo.updated_at\r\n      })) as Repo[]\r\n      const newRepos = this.state.repos.concat(repos)\r\n\r\n      this.setState({ repos: newRepos })\r\n      this.setState({ isLoading: false })\r\n    } catch (err) {\r\n      this.setState({ isLoading: false })\r\n      Swal.fire('503', '無法取得 Repositories，請稍後再試', 'error')\r\n    }\r\n  }\r\n\r\n  loadMoreRepos = async (entries: IntersectionObserverEntry[]) => {\r\n    const state = this.state\r\n    if (state.isLoading) return void 0\r\n\r\n    // ob 初始化時，不加載\r\n    const { isIntersecting } = entries[0]\r\n    const windowHeight = window.innerHeight\r\n    const obPosition = (this.obRef.current as HTMLDivElement).offsetTop\r\n    const isOverWindow = obPosition > windowHeight\r\n    if (!isIntersecting || !isOverWindow) return void 0\r\n\r\n    // 滿足條件時 loadMore\r\n    const page = state.page + 1\r\n    this.setState({ page })\r\n    await this.fetchRepos(page)\r\n\r\n    // 如分頁資料已全數加載，移除 observe\r\n    if (page === this.props.totalPage) {\r\n      this.observe.disconnect()\r\n      this.observe = null as any\r\n    }\r\n  }\r\n\r\n  ifSpinner() {\r\n    return this.state.isLoading ? <Spinner /> : null\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.fetchRepos(this.state.page)\r\n\r\n    // 滾動分頁\r\n    this.observe = new IntersectionObserver(this.loadMoreRepos)\r\n    this.observe.observe(this.obRef.current as HTMLDivElement)\r\n  }\r\n\r\n  render() {\r\n    const repos = this.state.repos\r\n\r\n    return (\r\n      <>\r\n        <div className=\"mt-3 mt-md-0 text-center text-md-start\">\r\n          <span className=\"fw-bold me-1\">Repositories</span>\r\n          <span className=\"badge rounded-pill bg-secondary\">{ repos.length }</span>\r\n        </div>\r\n        <hr />\r\n        <div className=\"position-relative\">\r\n          {repos.map(repo =>\r\n            <RepoCard key={repo.id} repo={repo}></RepoCard>\r\n          )}\r\n          { this.ifSpinner() }\r\n        </div>\r\n        <div ref={this.obRef}></div>\r\n      </>\r\n    )\r\n  }\r\n}\r\n\r\nexport default Repos","import React, { Component } from 'react'\r\nimport githubAPI from '../apis/githubAPI'\r\n\r\nimport UserCard from '../components/UserCard'\r\nimport Repos from '../components/Repos'\r\nimport './Home.css'\r\n\r\nclass Home extends Component {\r\n  state = {\r\n    totalPage: 0,\r\n  }\r\n  pageLimit = githubAPI.pageLimit\r\n  bgImg = React.createRef() as React.RefObject<HTMLDivElement>\r\n  bgPath = `${process.env.PUBLIC_URL}/img/gundamcat.png`\r\n\r\n  updateTotalPage = (reposSize: number) => {\r\n    this.setState({ totalPage: Math.ceil(reposSize / this.pageLimit) })\r\n  }\r\n\r\n  handleScroll = () => {\r\n    // 行動裝置時，不動作\r\n    if (window.innerWidth < 768) return\r\n    const bgImg = this.bgImg.current as HTMLElement\r\n    const scrollTop = +window.scrollY.toFixed(1)\r\n\r\n    bgImg.style.backgroundPositionY = `${scrollTop * 0.7}px`\r\n    bgImg.style.opacity = `${scrollTop * 0.0005}`\r\n  }\r\n\r\n  componentDidMount() {\r\n    // 背景圖視差滾動 (mobile 不動作)\r\n    if (window.innerWidth > 768) {\r\n      window.addEventListener('scroll', this.handleScroll)\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"container py-5\">\r\n        <div className=\"row\">\r\n          <div className=\"col-md-3\">\r\n            <UserCard onFetchedUser={this.updateTotalPage}/>\r\n            <div\r\n              className=\"bg-img mt-5\"\r\n              style={{backgroundImage: `url(${this.bgPath})`}}\r\n              ref={this.bgImg}\r\n            ></div>\r\n          </div>\r\n          <div className=\"col-md-9\">\r\n            <Repos totalPage={this.state.totalPage} />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default Home\r\n","import Home from './views/Home'\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <Home />\n    </div>\n  )\n}\n\nexport default App\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n)\n"],"sourceRoot":""}